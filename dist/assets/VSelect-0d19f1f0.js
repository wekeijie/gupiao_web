import{m as fe,V as $}from"./VTextField-33b47618.js";import{ab as Q,a5 as _,p as X,ag as me,cE as ve,db as pe,dt as he,i as ye,ac as ge,A as B,r as j,q as b,x as Ve,cI as we,d5 as z,y as s,Y as O,a8 as A,cY as ke,F as Y,du as be,aj as Ce,G as Pe,dv as W,af as xe,dw as G,dm as Se}from"./index-ee50c606.js";import{d as Ae}from"./VInput-515ffb53.js";import{m as Te,u as De,V as Ie,a as J}from"./VList-c869dabd.js";import{V as Fe}from"./VMenu-b309ab48.js";import{V as Re}from"./VVirtualScroll-831b0050.js";import{V as Be}from"./VCheckboxBtn-464143df.js";import{V as Le}from"./VChip-1eba20ac.js";function Ee(e,L){const n=Q(!1);let y;function v(i){cancelAnimationFrame(y),n.value=!0,y=requestAnimationFrame(()=>{y=requestAnimationFrame(()=>{n.value=!1})})}async function D(){await new Promise(i=>requestAnimationFrame(i)),await new Promise(i=>requestAnimationFrame(i)),await new Promise(i=>requestAnimationFrame(i)),await new Promise(i=>{if(n.value){const a=_(n,()=>{a(),i()})}else i()})}async function C(i){var I,F;if(i.key==="Tab"&&((I=L.value)==null||I.focus()),!["PageDown","PageUp","Home","End"].includes(i.key))return;const a=(F=e.value)==null?void 0:F.$el;if(!a)return;(i.key==="Home"||i.key==="End")&&a.scrollTo({top:i.key==="Home"?0:a.scrollHeight,behavior:"smooth"}),await D();const g=a.querySelectorAll(":scope > :not(.v-virtual-scroll__spacer)");if(i.key==="PageDown"||i.key==="Home"){const o=a.getBoundingClientRect().top;for(const V of g)if(V.getBoundingClientRect().top>=o){V.focus();break}}else{const o=a.getBoundingClientRect().bottom;for(const V of[...g].reverse())if(V.getBoundingClientRect().bottom<=o){V.focus();break}}}return{onScrollPassive:v,onKeydown:C}}const Oe=X({chips:Boolean,closableChips:Boolean,closeText:{type:String,default:"$vuetify.close"},openText:{type:String,default:"$vuetify.open"},eager:Boolean,hideNoData:Boolean,hideSelected:Boolean,listProps:{type:Object},menu:Boolean,menuIcon:{type:me,default:"$dropdown"},menuProps:{type:Object},multiple:Boolean,noDataText:{type:String,default:"$vuetify.noDataText"},openOnClear:Boolean,itemColor:String,...Te({itemChildren:!1})},"Select"),_e=X({...Oe(),...ve(fe({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...pe({transition:{component:he}})},"VSelect"),ze=ye()({name:"VSelect",props:_e(),emits:{"update:focused":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,L){let{slots:n}=L;const{t:y}=ge(),v=B(),D=B(),C=B(),i=j(e,"menu"),a=b({get:()=>i.value,set:t=>{var l;i.value&&!t&&((l=D.value)!=null&&l.Î¨openChildren.size)||(i.value=t)}}),{items:g,transformIn:I,transformOut:F}=De(e),o=j(e,"modelValue",[],t=>I(t===null?[null]:Se(t)),t=>{const l=F(t);return e.multiple?l:l[0]??null}),V=b(()=>typeof e.counterValue=="function"?e.counterValue(o.value):typeof e.counterValue=="number"?e.counterValue:o.value.length),P=Ae(),Z=b(()=>o.value.map(t=>t.value)),w=Q(!1),H=b(()=>a.value?e.closeText:e.openText);let E="",q;const x=b(()=>e.hideSelected?g.value.filter(t=>!o.value.some(l=>e.valueComparator(l,t))):g.value),K=b(()=>e.hideNoData&&!x.value.length||e.readonly||(P==null?void 0:P.isReadonly.value)),ee=b(()=>{var t;return{...e.menuProps,activatorProps:{...((t=e.menuProps)==null?void 0:t.activatorProps)||{},"aria-haspopup":"listbox"}}}),T=B(),te=Ee(T,v);function ne(t){e.openOnClear&&(a.value=!0)}function le(){K.value||(a.value=!a.value)}function ae(t){W(t)&&M(t)}function M(t){var p,u;if(!t.key||e.readonly||P!=null&&P.isReadonly.value)return;["Enter"," ","ArrowDown","ArrowUp","Home","End"].includes(t.key)&&t.preventDefault(),["Enter","ArrowDown"," "].includes(t.key)&&(a.value=!0),["Escape","Tab"].includes(t.key)&&(a.value=!1),t.key==="Home"?(p=T.value)==null||p.focus("first"):t.key==="End"&&((u=T.value)==null||u.focus("last"));const l=1e3;if(e.multiple||!W(t))return;const r=performance.now();r-q>l&&(E=""),E+=t.key.toLowerCase(),q=r;const h=g.value.find(c=>c.title.toLowerCase().startsWith(E));if(h!==void 0){o.value=[h];const c=x.value.indexOf(h);z&&window.requestAnimationFrame(()=>{var d;c>=0&&((d=C.value)==null||d.scrollToIndex(c))})}}function R(t){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(!t.props.disabled)if(e.multiple){const r=o.value.findIndex(p=>e.valueComparator(p.value,t.value)),h=l??!~r;if(~r){const p=h?[...o.value,t]:[...o.value];p.splice(r,1),o.value=p}else h&&(o.value=[...o.value,t])}else{const r=l!==!1;o.value=r?[t]:[],xe(()=>{a.value=!1})}}function oe(t){var l;(l=T.value)!=null&&l.$el.contains(t.relatedTarget)||(a.value=!1)}function ue(){var t;e.eager&&((t=C.value)==null||t.calculateVisibleItems())}function ie(){var t;w.value&&((t=v.value)==null||t.focus())}function se(t){w.value=!0}function re(t){if(t==null)o.value=[];else if(G(v.value,":autofill")||G(v.value,":-webkit-autofill")){const l=g.value.find(r=>r.title===t);l&&R(l)}else v.value&&(v.value.value="")}return _(a,()=>{if(!e.hideSelected&&a.value&&o.value.length){const t=x.value.findIndex(l=>o.value.some(r=>e.valueComparator(r.value,l.value)));z&&window.requestAnimationFrame(()=>{var l;t>=0&&((l=C.value)==null||l.scrollToIndex(t))})}}),_(()=>e.items,(t,l)=>{a.value||w.value&&!l.length&&t.length&&(a.value=!0)}),Ve(()=>{const t=!!(e.chips||n.chip),l=!!(!e.hideNoData||x.value.length||n["prepend-item"]||n["append-item"]||n["no-data"]),r=o.value.length>0,h=$.filterProps(e),p=r||!w.value&&e.label&&!e.persistentPlaceholder?void 0:e.placeholder;return s($,A({ref:v},h,{modelValue:o.value.map(u=>u.props.value).join(", "),"onUpdate:modelValue":re,focused:w.value,"onUpdate:focused":u=>w.value=u,validationValue:o.externalValue,counterValue:V.value,dirty:r,class:["v-select",{"v-select--active-menu":a.value,"v-select--chips":!!e.chips,[`v-select--${e.multiple?"multiple":"single"}`]:!0,"v-select--selected":o.value.length,"v-select--selection-slot":!!n.selection},e.class],style:e.style,inputmode:"none",placeholder:p,"onClick:clear":ne,"onMousedown:control":le,onBlur:oe,onKeydown:M,"aria-label":y(H.value),title:y(H.value)}),{...n,default:()=>s(O,null,[s(Fe,A({ref:D,modelValue:a.value,"onUpdate:modelValue":u=>a.value=u,activator:"parent",contentClass:"v-select__content",disabled:K.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterEnter:ue,onAfterLeave:ie},ee.value),{default:()=>[l&&s(Ie,A({ref:T,selected:Z.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:u=>u.preventDefault(),onKeydown:ae,onFocusin:se,tabindex:"-1","aria-live":"polite",color:e.itemColor??e.color},te,e.listProps),{default:()=>{var u,c,d;return[(u=n["prepend-item"])==null?void 0:u.call(n),!x.value.length&&!e.hideNoData&&(((c=n["no-data"])==null?void 0:c.call(n))??s(J,{title:y(e.noDataText)},null)),s(Re,{ref:C,renderless:!0,items:x.value},{default:k=>{var U;let{item:m,index:S,itemRef:f}=k;const N=A(m.props,{ref:f,key:S,onClick:()=>R(m,null)});return((U=n.item)==null?void 0:U.call(n,{item:m,index:S,props:N}))??s(J,A(N,{role:"option"}),{prepend:ce=>{let{isSelected:de}=ce;return s(O,null,[e.multiple&&!e.hideSelected?s(Be,{key:m.value,modelValue:de,ripple:!1,tabindex:"-1"},null):void 0,m.props.prependAvatar&&s(ke,{image:m.props.prependAvatar},null),m.props.prependIcon&&s(Y,{icon:m.props.prependIcon},null)])}})}}),(d=n["append-item"])==null?void 0:d.call(n)]}})]}),o.value.map((u,c)=>{function d(f){f.stopPropagation(),f.preventDefault(),R(u,!1)}const k={"onClick:close":d,onKeydown(f){f.key!=="Enter"&&f.key!==" "||(f.preventDefault(),f.stopPropagation(),d(f))},onMousedown(f){f.preventDefault(),f.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},m=t?!!n.chip:!!n.selection,S=m?be(t?n.chip({item:u,index:c,props:k}):n.selection({item:u,index:c})):void 0;if(!(m&&!S))return s("div",{key:u.value,class:"v-select__selection"},[t?n.chip?s(Ce,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:u.title}}},{default:()=>[S]}):s(Le,A({key:"chip",closable:e.closableChips,size:"small",text:u.title,disabled:u.props.disabled},k),null):S??s("span",{class:"v-select__selection-text"},[u.title,e.multiple&&c<o.value.length-1&&s("span",{class:"v-select__selection-comma"},[Pe(",")])])])})]),"append-inner":function(){var k;for(var u=arguments.length,c=new Array(u),d=0;d<u;d++)c[d]=arguments[d];return s(O,null,[(k=n["append-inner"])==null?void 0:k.call(n,...c),e.menuIcon?s(Y,{class:"v-select__menu-icon",icon:e.menuIcon},null):void 0])}})}),we({isFocused:w,menu:a,select:R},v)}});export{ze as V};
