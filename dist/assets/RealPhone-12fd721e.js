import{M as I,z as m,ad as x,O as w,as as C,P as e,A as i,Q as u,x as s,C as c,I as p,D as S,F as f,S as d,W as b}from"./index-4a165d8b.js";import{P}from"./topWrap-e1bc8341.js";import{a as V,c as h}from"./vaildRule-ef5259b5.js";import{_ as R}from"./_plugin-vue_export-helper-c27b6911.js";import{V as N}from"./VForm-b1e51a16.js";import{V as _}from"./VTextField-4f94d19c.js";import{V as q}from"./VDivider-b7bad0fc.js";/* empty css                                                                */import"./VInput-6ffe17b0.js";import"./index-7a90beb4.js";const B={class:"login-box"},D={key:0},U={key:1},F={key:0},M={key:1},z={class:"login-box"},T={__name:"RealPhone",setup(A){I(),m("password");const a=x({mobile:"",code:"",new_code:""}),t=m(0),k=()=>{t.value=60,e.dispatch("user/sendSms","");let r=setInterval(()=>{t.value--,t.value<=0&&(t.value=0,clearInterval(r))},1e3)},n=m(0),g=()=>{if(a.mobile.length<11){e.dispatch("snackbar/warning",{active:!0,body:"新手机号码不能为空"});return}n.value=60,e.dispatch("user/sendSms",a.mobile);let r=setInterval(()=>{n.value--,n.value<=0&&(n.value=0,clearInterval(r))},1e3)},y=async()=>{const{valid:r}=await v.ctx.$refs.form.validate();r&&e.dispatch("user/changeMobile",a).then(()=>{e.dispatch("snackbar/success",{active:!0,body:"修改成功!"}),e.dispatch("user/getInfo")})};let v=m();return w(()=>{v=C(),e.state.user.userInfo.user_name||e.dispatch("user/getInfo")}),(r,o)=>(i(),u("div",null,[s(P,null,{headerCenter:c(()=>[f("已绑定手机号")]),_:1}),p("div",B,[s(N,{ref:"form"},{default:c(()=>[s(_,{variant:"underlined",modelValue:d(e).state.user.userInfo.mobile,"onUpdate:modelValue":o[0]||(o[0]=l=>d(e).state.user.userInfo.mobile=l),required:"",readonly:"",counter:12,clearable:"",label:"手机号码","hide-details":"auto","prepend-icon":"mdi-phone",rules:d(V)},null,8,["modelValue","rules"]),s(_,{variant:"underlined",modelValue:a.code,"onUpdate:modelValue":o[1]||(o[1]=l=>a.code=l),required:"",counter:12,label:"请输入旧手机验证码",type:"Number","prepend-icon":"mdi-lock",rules:d(h)},{default:c(()=>[p("div",{class:"send-code",onClick:k},[t.value==0?(i(),u("p",D,"点击发送")):(i(),u("p",U,"重新发送("+b(t.value)+")",1))])]),_:1},8,["modelValue","rules"]),s(_,{variant:"underlined",modelValue:a.mobile,"onUpdate:modelValue":o[2]||(o[2]=l=>a.mobile=l),required:"",counter:12,clearable:"",label:"新手机号码","hide-details":"auto","prepend-icon":"mdi-phone",rules:d(V)},null,8,["modelValue","rules"]),s(_,{variant:"underlined",modelValue:a.new_code,"onUpdate:modelValue":o[3]||(o[3]=l=>a.new_code=l),required:"",counter:12,label:"请输入新手机验证码",type:"Number","prepend-icon":"mdi-lock",rules:d(h)},{default:c(()=>[p("div",{class:"send-code",onClick:g},[n.value==0?(i(),u("p",F,"点击发送")):(i(),u("p",M,"重新发送("+b(n.value)+")",1))])]),_:1},8,["modelValue","rules"])]),_:1},512)]),s(q,{thickness:3}),p("div",z,[s(S,{color:"#fb5c39",class:"mt-4",size:"x-large",block:"",onClick:y},{default:c(()=>[f(" 更换手机号 ")]),_:1})])]))}},K=R(T,[["__scopeId","data-v-a3125bac"]]);export{K as default};
