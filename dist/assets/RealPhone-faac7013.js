import{K as I,r as m,a as x,o as w,ae as C,a1 as e,N as i,a0 as u,J as l,P as c,Y as p,Q as S,S as f,T as d,a5 as b}from"./index-a06fd1c4.js";import{P as N}from"./topWrap-17fd4560.js";import{a as V,c as h}from"./vaildRule-ddcbecb2.js";import{_ as P}from"./_plugin-vue_export-helper-c27b6911.js";import{V as R}from"./VForm-388c74df.js";import{V as _}from"./VTextField-4765c64c.js";import{V as q}from"./VDivider-beffab46.js";/* empty css                                                                */import"./VInput-2cd45ae7.js";import"./index-dbb1006a.js";import"./index-bff874b1.js";const B={class:"login-box"},U={key:0},D={key:1},T={key:0},F={key:1},M={class:"login-box"},z={__name:"RealPhone",setup(E){I(),m("password");const a=x({mobile:"",code:"",new_code:""}),t=m(0),k=()=>{t.value=60,e.dispatch("user/sendSms","");let r=setInterval(()=>{t.value--,t.value<=0&&(t.value=0,clearInterval(r))},1e3)},n=m(0),g=()=>{if(a.mobile.length<11){e.dispatch("snackbar/warning",{active:!0,body:"新手机号码不能为空"});return}n.value=60,e.dispatch("user/sendSms",a.mobile);let r=setInterval(()=>{n.value--,n.value<=0&&(n.value=0,clearInterval(r))},1e3)},y=async()=>{const{valid:r}=await v.ctx.$refs.form.validate();r&&e.dispatch("user/changeMobile",a).then(()=>{e.dispatch("snackbar/success",{active:!0,body:"修改成功!"}),e.dispatch("user/getInfo")})};let v=m();return w(()=>{v=C(),e.state.user.userInfo.user_name||e.dispatch("user/getInfo")}),(r,o)=>(i(),u("div",null,[l(N,null,{headerCenter:c(()=>[f("已绑定手机号")]),_:1}),p("div",B,[l(R,{ref:"form"},{default:c(()=>[l(_,{variant:"underlined",modelValue:d(e).state.user.userInfo.mobile,"onUpdate:modelValue":o[0]||(o[0]=s=>d(e).state.user.userInfo.mobile=s),required:"",readonly:"",counter:12,clearable:"",label:"手机号码","hide-details":"auto","prepend-icon":"mdi-phone",rules:d(V)},null,8,["modelValue","rules"]),l(_,{variant:"underlined",modelValue:a.code,"onUpdate:modelValue":o[1]||(o[1]=s=>a.code=s),required:"",counter:12,label:"请输入旧手机验证码",type:"Number","prepend-icon":"mdi-lock",rules:d(h)},{default:c(()=>[p("div",{class:"send-code",onClick:k},[t.value==0?(i(),u("p",U,"点击发送")):(i(),u("p",D,"重新发送("+b(t.value)+")",1))])]),_:1},8,["modelValue","rules"]),l(_,{variant:"underlined",modelValue:a.mobile,"onUpdate:modelValue":o[2]||(o[2]=s=>a.mobile=s),required:"",counter:12,clearable:"",label:"新手机号码","hide-details":"auto","prepend-icon":"mdi-phone",rules:d(V)},null,8,["modelValue","rules"]),l(_,{variant:"underlined",modelValue:a.new_code,"onUpdate:modelValue":o[3]||(o[3]=s=>a.new_code=s),required:"",counter:12,label:"请输入新手机验证码",type:"Number","prepend-icon":"mdi-lock",rules:d(h)},{default:c(()=>[p("div",{class:"send-code",onClick:g},[n.value==0?(i(),u("p",T,"点击发送")):(i(),u("p",F,"重新发送("+b(n.value)+")",1))])]),_:1},8,["modelValue","rules"])]),_:1},512)]),l(q,{thickness:3}),p("div",M,[l(S,{color:"#fb5c39",class:"mt-4",size:"x-large",block:"",onClick:y},{default:c(()=>[f(" 更换手机号 ")]),_:1})])]))}},W=P(z,[["__scopeId","data-v-a3125bac"]]);export{W as default};
